### 프로세스와 스레드

<img width="756" alt="스크린샷 2023-08-02 오후 3 04 45" src="https://github.com/ehdgusdl9177/NodeJs/assets/75515697/f58b553c-18ae-43ac-bece-711cef7fe395">
<img width="760" alt="스크린샷 2023-08-02 오후 3 05 41" src="https://github.com/ehdgusdl9177/NodeJs/assets/75515697/c7c8266f-d9dd-4dac-8b1d-4cea9fe8dccd">

### 프로세스(Process)

- 컴퓨터가 구글 크폼 프로그램을 실행하든 카카오톡 프로그램을 실행하든 어떠한 일을 하고 있는 상태를 프로세스라고 한다.
- 프로세서(processors)가 프로세스(process)를 하나씩 조금씩 빠르게 처리해서 같이 모든 프로세스를 처리하는 것처엄 보이는 동시성과 여러개의 프로세서가 여러개의 프로세스를 각각 동시에 처리해주는 병렬성을 같이 이용해서 처리해 준다.

<img width="755" alt="스크린샷 2023-08-02 오후 3 33 31" src="https://github.com/ehdgusdl9177/NodeJs/assets/75515697/49b92f64-e70c-45fe-bdca-45e0a610affd">

### 쓰레드(Thread)

- 카카오 프로그램을 실행해 놓으면 알림도 오고 메시지도 오고 광고도 나와야한다.
- 결국 한 프로세스 내에서 여러가지 작업이 동시에 이뤄져야한다.
- 이 때 쓰레드를 이용하게 된다.
- 즉 쓰레드란 프로세스 내에서 일을 처리하는 세부 실행 단위를 말한다.

<img width="843" alt="스크린샷 2023-08-02 오후 3 34 22" src="https://github.com/ehdgusdl9177/NodeJs/assets/75515697/2096fc33-0d78-48fe-a7cf-461e06458e6f">

### 쓰레드는 자원 공유

- 아래의 그림에서처럼 하나의 프로세스안에서 쓰레드들은 자원을 공유하게 된다.
- 장점
  - 카카오톡 프로세스 안에서는 비슷한 일을 할 수 있기 때문에 자원을 공유하는 게 효율적이다.
- 단점
  - 자원을 공유해서 나오는 단점은 공유하는 자원에 여러개의 쓰레드가 동시에 접근할 때 에러가 날 수 있다.
  - 이러한 경우르 위한 코딩을 하기도 디버깅을 하기도 어렵다.

<img width="732" alt="스크린샷 2023-08-02 오후 3 34 37" src="https://github.com/ehdgusdl9177/NodeJs/assets/75515697/e6dd6ce9-0ea0-40f5-ba60-181226381063">

### 프로세스 좀 더 자세히 보기

- 실행파일을 클릭했을 때, 메모리(RAM)할당이 이루어지고 이 순간부터 이 프로그램은 '프로세스'라 불리게 된다.
- 다음 이미지는 메인 메모리 내부 프로세스의 단순화된 레이아웃을 보여준다.

<img width="252" alt="스크린샷 2023-08-02 오후 3 34 46" src="https://github.com/ehdgusdl9177/NodeJs/assets/75515697/d3a5509f-3518-4876-b13f-ca513a3ec1ea">

- Stack
  - 프로세스 스택에는 메서드/함수 매개변수, 반환 주소 및 지역 변수와 같은 임시 데이터가 포함된다.
- Heap
  - 이것은 런타임 동안 프로세스에 동적으로 할당된 메모리이다.
- Data
  - 이 섹션에는 전역 및 정적 변수가 포함되어있다.
- Text

  - 여기에는 Program Counter 값과 프로세서 레지스터의 내용이 나타내는 현재 활동이 포함된다.

- Heap의 영역이 증가하여 Stack 영역을 침범하는 상황 ==> Heap Overflow.
- Stack의 영역이 증가하여 Heap 영역을 침범하는 상황 ==> Stack Overflow.
- 이러한상황이 될 때 사용되는 메모리의 자유 영역 또한 존재한다.
- 프로세스 메모리의 속도는 Stack > Data > Code > Heap 순으로 빠르다.

### 싱글 스레드

<img width="277" alt="스크린샷 2023-08-02 오후 3 35 05" src="https://github.com/ehdgusdl9177/NodeJs/assets/75515697/cc58f019-6e09-43e9-bb97-82eece0c6162">

- 하나의 프로세스에서 하나의 스레드를 실행한다.
- 그래서 프로세스 내의 작업을 순차적으로 실행한다.
- 위와 같은 특징으로 인해서 여러가지 작업 처리가 늦어 질 수 있다.

<img width="152" alt="스크린샷 2023-08-02 오후 3 35 34" src="https://github.com/ehdgusdl9177/NodeJs/assets/75515697/d6636133-1697-4dae-95ad-46ae4ecb49ba">

### 멀티 스레드

<img width="344" alt="스크린샷 2023-08-02 오후 3 35 17" src="https://github.com/ehdgusdl9177/NodeJs/assets/75515697/8cf842ca-92a1-4939-8a65-a5521daf2c1d">

- 하나의 프로세스 내에 여러 개의 스레드가 실행된다.
- 각각의 스레드가 다른 작업을 할당받아서, 프로세스가 병렬적으로 여러 작업을 동시에 수행할 수 있다.
- 각각 Stack만 따로 할당받고 Code, Data, Heap 영역은 공유한다.

<img width="403" alt="스크린샷 2023-08-02 오후 3 35 42" src="https://github.com/ehdgusdl9177/NodeJs/assets/75515697/f7606875-738a-4bb6-a86a-111801d16593">

### 멀티 스레딩의 단점

- 공유하는 자원에서 동시에 접근할 때 신경을 써줘야한다.
- 스레드 간에 데이터와 힙 영역을 공유하기 때문에 변수나 자료 구조에서 겹쳐서 오류가 날 수 있다.
- 이러한 문제로 동기화 작업이 필요하다.
- 병목 현상이라는 게 생겨서 성능을 저하시킬 수 있다.
- 결국은 멀티 스레딩을 관리하는 것은 쉽지 않다.
